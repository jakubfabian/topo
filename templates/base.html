<!DOCTYPE html>
<html>

{% load static %}

<head>
    <title>

        {% block title %}
            Mei Topo - Topos for everyone
        {% endblock %}

    </title>

    <link href="{% static "miroutes/bower_components/select2/dist/css/select2.min.css" %}" rel="stylesheet"/>
    {% block jquery_import %}
        <script type="text/javascript" src={% static "miroutes/js/jquery-2.2.2.js" %}></script>
        <script type="text/javascript"
                src={% static "miroutes/js/jquery-ui-1.12.0-rc.1.custom/jquery-ui.js" %}></script>
        <script src="{% static "miroutes/bower_components/select2/dist/js/select2.js" %}"></script>

    {% endblock %}

    {% block extra_assets %}


    {% endblock %}
    {% block main-css %}
        <link href='https://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href={% static "miroutes/css/main3.css" %}/>
    {% endblock %}

</head>

<body>
<div id="contentcontainer">

    {% block header %}


        <div id="user-menu">
            <a href="/miroutes">
                <img id="logo" src="{% static "miroutes/img/logo.png" %}"/>
            </a>
            <div id="login-menu">
                {% if user.is_anonymous %}
                    <a href="{% url 'django.contrib.auth.views.login' %}?next={{ request.path }}">Login</a>
                    <a href="{% url 'users.views.register' %}">Register</a>
                {% else %}
                    User   : <b>{{ user }}</b>
                    (<a href="{% url 'django.contrib.auth.views.logout' %}?next={{ request.path }}">logout</a>)
                    &nbsp;&nbsp; Email  : {{ user.email }}
                {% endif %}
            </div>

            <div id="search-container">


                <select id="search-field">
                    <option value="NONE" selected="selected">select something ...</option>
                </select>
                <script type="text/javascript">

                    function formatRepo(repo) {
                        return repo.name;
                    }

                    function formatRepoSelection(repo) {
                        return repo.name;
                    }

                    $search_field = $('#search-field')
                    $search_field.select2({
                        debug: true,
                        ajax: {
                            url: "http://{{ request.get_host }}/miroutes/search/",
                            dataType: 'json',
                            quietMillis: 100,
                            minimumInputLength: 1,
                            data: function (params) {
                                return {
                                    q: params.term, // search term
                                    page: params.page
                                };
                            },
                            results: function (data) {
                                console.log(data);
                                return {
                                    results: data.items
                                };
                            }
                        }
                    });

                    $search_field.on("select2:select", function (entry) {
                        location.href = entry.params.data.url
                    });

                </script>

            </div>
        </div>
        <div id="messages">
            {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>

    {% endblock %}


    <div id="content">
        {% block content %}Default template content -- there is nothing to see here...{% endblock %}
    </div>
    <div class="mapobjects-info">

        <div class="inner_container">

            {% block mapobjects_info %}
            {% endblock %}
        </div>
    </div>

</div>

{% block footer %}
    <div id="footer">
        (c) die Kletteraffen
    </div>
{% endblock %}
</body>
</html>
