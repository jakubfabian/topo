{% extends "base.html" %}

{% block title %} 
	<title>Mitopo.de - Area Detail</title>
{% endblock %}

{% block extra_assets %}

<style>
.leaflet-container {  /* all maps */
    width:  100%;
    height: 400px;
}
</style>

{% load leaflet_tags %}
{% load geojson_tags %}
{% leaflet_js %}
{% leaflet_css %}

{% endblock %} 

{% block content %}

<a href="/miroutes/"> Home </a> : <a href=../../> {{ area.area_country.country_name }} </a> :: <a href="../" >{{ area.area_name }}

<br><br>
You're looking at area selection {{ area.area_name }}

{% if area_spot_list %}

      <script type="text/javascript">

      function map_init(map, options) {

        var markerArray = [];

        {% for spot in area_spot_list %}
            var coord = L.latLng({{ spot.geom.coordinates }});
            var newcoord = L.latLng(coord.lng, coord.lat);
            var mc = new L.marker(newcoord);
            mc.bindPopup("<a href={% url "spot_detail" spot_id=spot.id %}>{{ spot.spot_name }}</a>");
            markerArray.push(mc);
        {% endfor %}

        var group = L.featureGroup(markerArray).addTo(map);

        if (markerArray.length > 1){
                map.fitBounds(group.getBounds());
        } else {
            map.setView(markerArray[0].getLatLng(), 12);
        }	
      }
    </script>

    {% leaflet_map "spots" callback="window.map_init" %}


    In {{ area.area_name }} there are following spots:<br><br>

    {% for spot in area_spot_list %}
    <li><a href=" {% url "spot_detail" spot_id=spot.pk %} "> {{ spot.spot_name }}  {{ spot.geom.coordinates }}</a></li>
    {% endfor %}
    </ul>


{% else %}
    <p>Currently no spots are available in {{ area.area_name }}</p>
{% endif %}

{% endblock %}
